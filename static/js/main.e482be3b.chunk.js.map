{"version":3,"sources":["components/Selector.jsx","components/Results.jsx","constants.js","components/Footer.jsx","utils/fetchStates.js","utils/fetchDistricts.js","utils/url.js","App.js","index.js"],"names":["Selector","values","selectedValue","onSelect","classes","prefix","FormControl","variant","className","formControl","InputLabel","id","Select","labelId","value","onChange","label","autoWidth","map","name","MenuItem","now","dayjs","Results","district","age","useState","isLoading","setIsloading","capacity","setCapacity","isOpen","setIsOpen","useEffect","a","date","format","URL","fetch","then","res","json","centers","center","sessions","flattenDeep","s","available_capacity","min_age","min_age_limit","filter","reduce","ac","v","Math","floor","fetchResults","CircularProgress","style","flexDirection","alignItems","align","userSelect","onClick","navigator","clipboard","writeText","window","location","href","alert","cursor","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","message","action","IconButton","size","aria-label","color","fontSize","Footer","position","left","bottom","width","textAlign","target","fetchStates","states","fetchDistricts","districts","parseQueryString","obj","length","state","slice","split","forEach","trim","k","useStyles","makeStyles","theme","margin","spacing","minWidth","selectEmpty","marginTop","withRouter","setIsLoading","setStates","selectedState","setSelectedState","setDistricts","selectedDistrict","setSelectedDistrict","setAge","history","useHistory","search","useLocation","state_id","state_name","getStates","URLUtils","district_id","district_name","getDistricts","getChangeHandler","key","e","replace","toString","data","url","Object","entries","join","push","Container","maxWidth","TextField","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e482be3b.chunk.js","sourcesContent":["import InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\n\nconst Selector = ({ values, selectedValue, onSelect, classes, prefix }) => {\n  return (\n    <FormControl variant=\"outlined\" className={classes.formControl}>\n      <InputLabel id={`${prefix}-input-label`} className=\"input-label\">\n        {prefix}\n      </InputLabel>\n      <Select\n        labelId={`${prefix}-input-label`}\n        id={`${prefix}-input-select`}\n        value={selectedValue}\n        onChange={onSelect}\n        label={prefix}\n        autoWidth\n      >\n        {values.map(({ id, name }) => (\n          <MenuItem key={`prefix-${id}`} value={id}>\n            {name}\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n};\n\nexport default Selector;\n","import { useEffect, useState } from \"react\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport dayjs from \"dayjs\";\nimport flattenDeep from \"lodash.flattendeep\";\nimport { URLForSlots } from \"../constants\";\n\nconst now = dayjs();\n\nconst Results = ({ district, age }) => {\n  const [isLoading, setIsloading] = useState(false);\n  const [capacity, setCapacity] = useState(0);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const copyURL = () => {\n    navigator.clipboard.writeText(window.location.href).then(\n      () => setIsOpen(true),\n      () => alert(\"error copying\")\n    );\n  };\n\n  useEffect(() => {\n    const fetchResults = async () => {\n      if (+age < 18) {\n        setCapacity(0);\n        return;\n      }\n      setIsloading(true);\n      const date = now.format(\"DD-MM-YYYY\");\n      const URL = `${URLForSlots}district_id=${district}&date=${date}`;\n      fetch(URL)\n        .then((res) => res.json())\n        .then((res) => res.centers.map((center) => center.sessions))\n        .then((sessions) => flattenDeep(sessions))\n        .then((sessions) =>\n          sessions.map((s) => ({\n            capacity: s.available_capacity,\n            min_age: s.min_age_limit,\n          }))\n        )\n        .then((sessions) =>\n          sessions.filter((s) => s.capacity > 0 && s.min_age <= +age)\n        )\n        .then((sessions) => sessions.reduce((ac, v) => ac + v.capacity, 0))\n        .then((capacity) => {\n          setCapacity(Math.floor(capacity));\n          setIsloading(false);\n        });\n    };\n\n    fetchResults();\n  }, [district, age]);\n\n  return (\n    <>\n      {isLoading ? (\n        <div className=\"flex justify-center\">\n          <CircularProgress />\n        </div>\n      ) : (\n        <div\n          className=\"flex\"\n          style={{ flexDirection: \"column\", alignItems: \"center\" }}\n        >\n          <h1 align=\"center\">\n            There {capacity === 1 ? \"is\" : \"are\"} {capacity}{\" \"}\n            {capacity === 1 ? \"slot\" : \"slots\"} in the next 7 days!{\" \"}\n            {capacity === 0 ? \"😔\" : \"🚀\"}\n          </h1>\n          <span style={{ userSelect: \"none\" }}>\n            Want to check back again later?{\" \"}\n            <u onClick={copyURL} style={{ cursor: \"pointer\" }}>\n              Copy the URL!\n            </u>\n          </span>\n        </div>\n      )}\n      <Snackbar\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"left\",\n        }}\n        open={isOpen}\n        autoHideDuration={2000}\n        onClose={() => setIsOpen(false)}\n        message=\"Copied to clipboard\"\n        action={\n          <IconButton\n            size=\"small\"\n            aria-label=\"close\"\n            color=\"inherit\"\n            onClick={() => setIsOpen(false)}\n          >\n            <CloseIcon fontSize=\"small\" />\n          </IconButton>\n        }\n      />\n    </>\n  );\n};\n\nexport default Results;\n","export const URLForSlots =\n  \"https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByDistrict?\";\n","const Footer = () => {\n  return (\n    <footer\n      style={{\n        position: \"fixed\",\n        left: \"0px\",\n        bottom: \"25px\",\n        width: \"100%\",\n        fontSize: \"1.2em\",\n        color: \"grey\",\n        textAlign: \"center\",\n      }}\n    >\n      <div className=\"container\">\n        By{\" \"}\n        <a href=\"https://yashshah1.github.io\" target=\"_blank\">\n          Yash Shah\n        </a>\n      </div>\n    </footer>\n  );\n};\n\nexport default Footer;\n","const fetchStates = async () => {\n  return fetch(\"https://cdn-api.co-vin.in/api/v2/admin/location/states\")\n    .then((res) => res.json())\n    .then((res) => res.states);\n};\n\nexport default fetchStates;\n","const fetchDistricts = async (id) => {\n  return fetch(\n    `https://cdn-api.co-vin.in/api/v2/admin/location/districts/${id}`\n  )\n    .then((res) => res.json())\n    .then((res) => res.districts);\n};\n\nexport default fetchDistricts;\n","export const generateQueryString = (data) => {\n  return Object.entries(data)\n    .map(([k, v]) => (v.trim().length > 0 ? `${k}=${v}` : \"\"))\n    .join(\"&\");\n};\n\nexport const parseQueryString = (s) => {\n  const obj = {};\n  if (s.length <= 1) {\n    return { state: \"21\", district: \"363\", age: \"21\" };\n  }\n\n  const queryStringParams = s.slice(1).split(\"&\");\n  queryStringParams.forEach((s) => {\n    if (s.trim().length === 0) return;\n    const [k, v] = s.split(\"=\");\n    if (v.trim().length > 0) obj[k] = v;\n  });\n\n  return obj;\n};\n","import { useState, useEffect } from \"react\";\nimport { withRouter, useLocation, useHistory } from \"react-router-dom\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Container from \"@material-ui/core/Container\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\n\nimport Selector from \"./components/Selector\";\nimport Results from \"./components/Results\";\nimport Footer from \"./components/Footer\";\n\nimport fetchStates from \"./utils/fetchStates\";\nimport fetchDistricts from \"./utils/fetchDistricts\";\nimport * as URLUtils from \"./utils/url\";\n\nconst useStyles = makeStyles((theme) => ({\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  },\n  selectEmpty: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nfunction App() {\n  const [isLoading, setIsLoading] = useState(true);\n  const [states, setStates] = useState([]);\n  const [selectedState, setSelectedState] = useState(\"\");\n  const [districts, setDistricts] = useState([]);\n  const [selectedDistrict, setSelectedDistrict] = useState(\"\");\n  const [age, setAge] = useState(\"\");\n\n  const classes = useStyles();\n  const history = useHistory();\n  const { search } = useLocation();\n\n  useEffect(() => {\n    const getStates = async () => {\n      const states = await fetchStates();\n      setStates(\n        states.map(({ state_id, state_name }) => ({\n          id: state_id,\n          name: state_name,\n        }))\n      );\n      setIsLoading(false);\n    };\n    getStates();\n  }, []);\n\n  useEffect(() => {\n    const { state, district, age } = URLUtils.parseQueryString(search);\n    if (state) setSelectedState(state);\n    if (district) setSelectedDistrict(district);\n    setAge(age ? age : \"\");\n  }, [search]);\n\n  useEffect(() => {\n    setIsLoading(true);\n    const getDistricts = async () => {\n      const districts = await fetchDistricts(selectedState);\n      setDistricts(\n        districts.map(({ district_id, district_name }) => ({\n          id: district_id,\n          name: district_name,\n        }))\n      );\n      setIsLoading(false);\n    };\n    getDistricts();\n  }, [selectedState]);\n\n  const getChangeHandler = (key) => (e) => {\n    const obj = URLUtils.parseQueryString(search);\n    let value = e.target.value;\n    if (key === \"age\") value = value.replace(/\\D/g, \"\");\n    obj[key] = value.toString();\n    const url = URLUtils.generateQueryString(obj);\n    history.push(`?${url}`);\n  };\n\n  return (\n    <>\n      <Container maxWidth=\"sm\">\n        <h1 align=\"center\">Is a (vaccination) slot available for me?</h1>\n        <h3 align=\"center\">For people who are too lazy to login</h3>\n        <br />\n        {isLoading ? (\n          <div className=\"flex justify-center\">\n            <CircularProgress />\n          </div>\n        ) : (\n          <>\n            <div className=\"flex justify-center\">\n              <Selector\n                values={states}\n                selectedValue={selectedState}\n                classes={classes}\n                onSelect={getChangeHandler(\"state\")}\n                prefix=\"state\"\n              />\n\n              <Selector\n                values={districts}\n                selectedValue={selectedDistrict}\n                classes={classes}\n                onSelect={getChangeHandler(\"district\")}\n                prefix=\"district\"\n              />\n            </div>\n            <br />\n            {selectedDistrict !== \"\" && (\n              <div className=\"flex\" style={{ flexDirection: \"column\" }}>\n                <TextField\n                  id=\"outlined-basic\"\n                  label=\"Age\"\n                  variant=\"outlined\"\n                  width=\"sm\"\n                  value={age}\n                  onChange={getChangeHandler(\"age\")}\n                />\n              </div>\n            )}\n          </>\n        )}\n\n        <br />\n        <br />\n        {selectedDistrict !== \"\" && age !== \"\" && (\n          <Results district={selectedDistrict} age={age} />\n        )}\n      </Container>\n      <Footer />\n    </>\n  );\n}\n\nexport default withRouter(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}