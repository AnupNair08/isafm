{"version":3,"sources":["components/Selector.jsx","components/Results.jsx","constants.js","components/Footer.jsx","utils/fetchStates.js","utils/fetchDistricts.js","utils/url.js","App.js","index.js"],"names":["Selector","values","selectedValue","onSelect","classes","prefix","FormControl","variant","className","formControl","InputLabel","id","Select","labelId","value","onChange","label","autoWidth","map","name","MenuItem","now","dayjs","copyURL","navigator","clipboard","writeText","window","location","href","then","alert","Results","district","age","useState","isLoading","setIsloading","capacity","setCapacity","useEffect","a","date","format","URL","fetch","res","json","centers","center","sessions","flattenDeep","s","available_capacity","min_age","min_age_limit","filter","reduce","ac","v","fetchResults","style","flexDirection","alignItems","align","onClick","Footer","position","left","bottom","width","fontSize","color","textAlign","target","fetchStates","states","fetchDistricts","districts","parseQueryString","obj","length","state","slice","split","forEach","trim","k","useStyles","makeStyles","theme","margin","spacing","minWidth","selectEmpty","marginTop","withRouter","setIsLoading","setStates","selectedState","setSelectedState","setDistricts","selectedDistrict","setSelectedDistrict","setAge","history","useHistory","search","useLocation","state_id","state_name","getStates","URLUtils","district_id","district_name","getDistricts","getChangeHandler","key","e","replace","toString","data","url","Object","entries","join","push","Container","maxWidth","CircularProgress","TextField","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7e5944a9.chunk.js","sourcesContent":["import InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\n\nconst Selector = ({ values, selectedValue, onSelect, classes, prefix }) => {\n  return (\n    <FormControl variant=\"outlined\" className={classes.formControl}>\n      <InputLabel id={`${prefix}-input-label`} className=\"input-label\">\n        {prefix}\n      </InputLabel>\n      <Select\n        labelId={`${prefix}-input-label`}\n        id={`${prefix}-input-select`}\n        value={selectedValue}\n        onChange={onSelect}\n        label={prefix}\n        autoWidth\n      >\n        {values.map(({ id, name }) => (\n          <MenuItem key={`prefix-${id}`} value={id}>\n            {name}\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n};\n\nexport default Selector;\n","import { useEffect, useState } from \"react\";\nimport dayjs from \"dayjs\";\nimport flattenDeep from \"lodash.flattendeep\";\nimport { URLForSlots } from \"../constants\";\nconst now = dayjs();\n\nconst copyURL = () => {\n  navigator.clipboard.writeText(window.location.href).then(\n    () => {},\n    () => alert(\"error copying\")\n  );\n};\n\nconst Results = ({ district, age }) => {\n  const [isLoading, setIsloading] = useState(false);\n  const [capacity, setCapacity] = useState(0);\n\n  useEffect(() => {\n    const fetchResults = async () => {\n      if (+age < 18) {\n        setCapacity(0);\n        return;\n      }\n      setIsloading(true);\n      const date = now.format(\"DD-MM-YYYY\");\n      const URL = `${URLForSlots}district_id=${district}&date=${date}`;\n      fetch(URL)\n        .then((res) => res.json())\n        .then((res) => res.centers.map((center) => center.sessions))\n        .then((sessions) => flattenDeep(sessions))\n        .then((sessions) =>\n          sessions.map((s) => ({\n            capacity: s.available_capacity,\n            min_age: s.min_age_limit,\n          }))\n        )\n        .then((sessions) =>\n          sessions.filter((s) => s.capacity > 0 && s.min_age <= +age)\n        )\n        .then((sessions) => sessions.reduce((ac, v) => ac + v.capacity, 0))\n        .then((capacity) => {\n          setCapacity(capacity);\n          setIsloading(false);\n        });\n    };\n\n    fetchResults();\n  }, [district, age]);\n\n  return (\n    <>\n      {isLoading ? (\n        \"Loading\"\n      ) : (\n        <div\n          className=\"flex\"\n          style={{ flexDirection: \"column\", alignItems: \"center\" }}\n        >\n          <h1 align=\"center\">\n            There are {capacity} slots in the next 7 days!{\" \"}\n            {capacity === 0 ? \"ðŸ˜”\" : \"ðŸš€\"}\n          </h1>\n          <span>\n            Want to check back again later?{\" \"}\n            <u onClick={copyURL}>Copy the URL!</u>\n          </span>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Results;\n","export const URLForSlots =\n  \"https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByDistrict?\";\n","const Footer = () => {\n  return (\n    <footer\n      style={{\n        position: \"fixed\",\n        left: \"0px\",\n        bottom: \"25px\",\n        width: \"100%\",\n        fontSize: \"1.2em\",\n        color: \"grey\",\n        textAlign: \"center\",\n      }}\n    >\n      <div className=\"container\">\n        By{\" \"}\n        <a href=\"https://yashshah1.github.io\" target=\"_blank\">\n          Yash Shah\n        </a>\n      </div>\n    </footer>\n  );\n};\n\nexport default Footer;\n","const fetchStates = async () => {\n  return fetch(\"https://cdn-api.co-vin.in/api/v2/admin/location/states\")\n    .then((res) => res.json())\n    .then((res) => res.states);\n};\n\nexport default fetchStates;\n","const fetchDistricts = async (id) => {\n  return fetch(\n    `https://cdn-api.co-vin.in/api/v2/admin/location/districts/${id}`\n  )\n    .then((res) => res.json())\n    .then((res) => res.districts);\n};\n\nexport default fetchDistricts;\n","export const generateQueryString = (data) => {\n  return Object.entries(data)\n    .map(([k, v]) => (v.trim().length > 0 ? `${k}=${v}` : \"\"))\n    .join(\"&\");\n};\n\nexport const parseQueryString = (s) => {\n  const obj = {};\n  if (s.length <= 1) {\n    return { state: \"21\", district: \"363\", age: \"21\" };\n  }\n\n  const queryStringParams = s.slice(1).split(\"&\");\n  queryStringParams.forEach((s) => {\n    if (s.trim().length === 0) return;\n    const [k, v] = s.split(\"=\");\n    if (v.trim().length > 0) obj[k] = v;\n  });\n\n  return obj;\n};\n","import { useState, useEffect } from \"react\";\nimport { withRouter, useLocation, useHistory } from \"react-router-dom\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Container from \"@material-ui/core/Container\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\n\nimport Selector from \"./components/Selector\";\nimport Results from \"./components/Results\";\nimport Footer from \"./components/Footer\";\n\nimport fetchStates from \"./utils/fetchStates\";\nimport fetchDistricts from \"./utils/fetchDistricts\";\nimport * as URLUtils from \"./utils/url\";\n\nconst useStyles = makeStyles((theme) => ({\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  },\n  selectEmpty: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nfunction App() {\n  const [isLoading, setIsLoading] = useState(true);\n  const [states, setStates] = useState([]);\n  const [selectedState, setSelectedState] = useState(\"\");\n  const [districts, setDistricts] = useState([]);\n  const [selectedDistrict, setSelectedDistrict] = useState(\"\");\n  const [age, setAge] = useState(\"\");\n\n  const classes = useStyles();\n  const history = useHistory();\n  const { search } = useLocation();\n\n  useEffect(() => {\n    const getStates = async () => {\n      const states = await fetchStates();\n      setStates(\n        states.map(({ state_id, state_name }) => ({\n          id: state_id,\n          name: state_name,\n        }))\n      );\n      setIsLoading(false);\n    };\n    getStates();\n  }, []);\n\n  useEffect(() => {\n    const { state, district, age } = URLUtils.parseQueryString(search);\n    if (state) setSelectedState(state);\n    if (district) setSelectedDistrict(district);\n    setAge(age ? age : \"\");\n  }, [search]);\n\n  useEffect(() => {\n    setIsLoading(true);\n    const getDistricts = async () => {\n      const districts = await fetchDistricts(selectedState);\n      setDistricts(\n        districts.map(({ district_id, district_name }) => ({\n          id: district_id,\n          name: district_name,\n        }))\n      );\n      setIsLoading(false);\n    };\n    getDistricts();\n  }, [selectedState]);\n\n  const getChangeHandler = (key) => (e) => {\n    const obj = URLUtils.parseQueryString(search);\n    let value = e.target.value;\n    if (key === \"age\") value = value.replace(/\\D/g, \"\");\n    obj[key] = value.toString();\n    const url = URLUtils.generateQueryString(obj);\n    history.push(`?${url}`);\n  };\n\n  return (\n    <>\n      <Container maxWidth=\"sm\">\n        <h1 align=\"center\">Is a slot available for me?</h1>\n        <h3 align=\"center\">For people who are too lazy to login</h3>\n        <br />\n        {isLoading ? (\n          <div className=\"flex justify-center\">\n            <CircularProgress />\n          </div>\n        ) : (\n          <>\n            <div className=\"flex justify-center\">\n              <Selector\n                values={states}\n                selectedValue={selectedState}\n                classes={classes}\n                onSelect={getChangeHandler(\"state\")}\n                prefix=\"state\"\n              />\n\n              <Selector\n                values={districts}\n                selectedValue={selectedDistrict}\n                classes={classes}\n                onSelect={getChangeHandler(\"district\")}\n                prefix=\"district\"\n              />\n            </div>\n            <br />\n            {selectedDistrict !== \"\" && (\n              <div className=\"flex\" style={{ flexDirection: \"column\" }}>\n                <TextField\n                  id=\"outlined-basic\"\n                  label=\"Age\"\n                  variant=\"outlined\"\n                  width=\"sm\"\n                  value={age}\n                  onChange={getChangeHandler(\"age\")}\n                />\n              </div>\n            )}\n          </>\n        )}\n\n        <br />\n        <br />\n        {selectedDistrict !== \"\" && age !== \"\" && (\n          <Results district={selectedDistrict} age={age} />\n        )}\n      </Container>\n      <Footer />\n    </>\n  );\n}\n\nexport default withRouter(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}